----------------------------------------------------------------------
rank=2

DDP
module.module.0.weight:
 torch.Size([2, 2]) 
 Parameter containing:
tensor([[ 0.2059,  0.1117],
        [-0.3558, -0.0257]], device='cuda:2', requires_grad=True)
torch.Size([2, 2]) 
 tensor([[-0.4257,  0.0528],
        [ 0.0000,  0.0000]], device='cuda:2')

FSDP
module._fsdp_wrapped_module.0.weight:
 torch.Size([0]) 
 Parameter containing:
tensor([], device='cuda:2', requires_grad=True)

TP-FSDP
module._fsdp_wrapped_module.0.weight:
 torch.Size([0]) 
 Parameter containing:
tensor([], device='cuda:2', requires_grad=True)
----------------------------------------------------------------------
rank=2

DDP
module.module.2.weight:
 torch.Size([2, 2]) 
 Parameter containing:
tensor([[-0.6096, -0.4934],
        [-0.1113, -0.6492]], device='cuda:2', requires_grad=True)
torch.Size([2, 2]) 
 tensor([[0.1134, 0.0000],
        [0.1134, 0.0000]], device='cuda:2')

FSDP
module._fsdp_wrapped_module.2.weight:
 torch.Size([2]) 
 Parameter containing:
tensor([-0.6096, -0.4934], device='cuda:2', requires_grad=True)
torch.Size([2]) 
 tensor([0.1134, 0.0000], device='cuda:2')

TP-FSDP
module._fsdp_wrapped_module.2.weight:
 torch.Size([2]) 
 Parameter containing:
tensor([-0.6096, -0.1113], device='cuda:2', requires_grad=True)
torch.Size([2]) 
 tensor([0.2269, 0.2269], device='cuda:2')
----------------------------------------------------------------------
rank=2

DDP
module.module.0.weight:
 torch.Size([2, 2]) 
 Parameter containing:
tensor([[ 0.2059,  0.1117],
        [-0.3558, -0.0257]], device='cuda:2', requires_grad=True)
torch.Size([2, 2]) 
 tensor([[-0.4257,  0.0528],
        [ 0.0000,  0.0000]], device='cuda:2')

FSDP
module._fsdp_wrapped_module.0.weight:
 torch.Size([0]) 
 Parameter containing:
tensor([], device='cuda:2', requires_grad=True)

TP-FSDP
module._fsdp_wrapped_module.0.weight:
 torch.Size([0]) 
 Parameter containing:
tensor([], device='cuda:2', requires_grad=True)
----------------------------------------------------------------------
rank=2

DDP
module.module.2.weight:
 torch.Size([2, 2]) 
 Parameter containing:
tensor([[-0.6096, -0.4934],
        [-0.1113, -0.6492]], device='cuda:2', requires_grad=True)
torch.Size([2, 2]) 
 tensor([[0.1134, 0.0000],
        [0.1134, 0.0000]], device='cuda:2')

FSDP
module._fsdp_wrapped_module.2.weight:
 torch.Size([2]) 
 Parameter containing:
tensor([-0.6096, -0.4934], device='cuda:2', requires_grad=True)
torch.Size([2]) 
 tensor([0.1134, 0.0000], device='cuda:2')

TP-FSDP
module._fsdp_wrapped_module.2.weight:
 torch.Size([2]) 
 Parameter containing:
tensor([-0.6096, -0.1113], device='cuda:2', requires_grad=True)
torch.Size([2]) 
 tensor([0.2269, 0.2269], device='cuda:2')
----------------------------------------------------------------------
rank=2

DDP
module.module.0.weight:
 torch.Size([2, 2]) 
 Parameter containing:
tensor([[ 0.2059,  0.1117],
        [-0.3558, -0.0257]], device='cuda:2', requires_grad=True)
torch.Size([2, 2]) 
 tensor([[-0.4257,  0.0528],
        [ 0.0000,  0.0000]], device='cuda:2')

FSDP
module._fsdp_wrapped_module.0.weight:
 torch.Size([0]) 
 Parameter containing:
tensor([], device='cuda:2', requires_grad=True)

TP-FSDP
module._fsdp_wrapped_module.0.weight:
 torch.Size([0]) 
 Parameter containing:
tensor([], device='cuda:2', requires_grad=True)
----------------------------------------------------------------------
----------------------------------------------------------------------
